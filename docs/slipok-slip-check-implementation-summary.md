# ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤: ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Å‡∏™‡∏•‡∏¥‡∏õ SlipOK ‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (LINE)

> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 2025-12-17

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏•‡∏¥‡∏õ‡πÅ‡∏ö‡∏ö ‚Äú‡∏á‡πà‡∏≤‡∏¢ ‡πÜ‚Äù ‡πÉ‡∏ô **LINE Group/Room** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå ‡πÇ‡∏î‡∏¢:
- ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö **‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (image)** ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°/‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏ß‡πâ
- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô **‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (text)** ‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°/‡∏´‡πâ‡∏≠‡∏á ‚Üí **‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö**
- ‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à‡πÉ‡∏ä‡πâ SlipOK API ‡πÅ‡∏•‡∏∞‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà API ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)

## ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)
1. ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ `/admin/settings2` ‚Üí ‡πÅ‡∏ó‡πá‡∏ö ‚Äú‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‚Äù
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‚Äú‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‚Äù ‡∏ó‡∏µ‡πà‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏Å‡∏•‡∏∏‡πà‡∏°/‡∏´‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Sender Bot + ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á)
3. ‡πÄ‡∏õ‡∏¥‡∏î ‚Äú‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏•‡∏¥‡∏õ SlipOK‚Äù ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏£‡∏≠‡∏Å:
   - `SlipOK API URL` (‡πÄ‡∏ä‡πà‡∏ô `https://api.slipok.com/api/line/apikey/57824`)
   - `SlipOK API Key` (‡πÄ‡∏ä‡πà‡∏ô `SLIPOKWU4P56T`)
4. ‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°/‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô‡∏™‡πà‡∏á ‚Äú‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‚Äù ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ú‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö (‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà API ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö)
### ‡∏™‡∏•‡∏¥‡∏õ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‚Äú‚úÖ ‡∏™‡∏•‡∏¥‡∏õ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‚Äù
- ‚Äúüí∞ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‚Äù (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- ‚Äúüë§ ‡∏ú‡∏π‡πâ‡πÇ‡∏≠‡∏ô‚Äù (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- ‚Äúüè¶ ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‚Äù (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- ‚Äúüïí ‡πÄ‡∏ß‡∏•‡∏≤‚Äù (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- ‚ÄúüèõÔ∏è ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÇ‡∏≠‡∏ô/‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‚Äù ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô ‚Äúbank code‚Äù ‡∏ñ‡πâ‡∏≤ API ‡∏™‡πà‡∏á‡∏°‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô `004`)

### ‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á/‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
- ‚Äú‚ùå ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô (code)‚Äù (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ code)
- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡∏à‡∏≤‡∏Å SlipOK (`message`)
- ‡∏ñ‡πâ‡∏≤ SlipOK ‡πÅ‡∏ô‡∏ö `data` ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏™‡∏•‡∏¥‡∏õ‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ (‡πÄ‡∏ä‡πà‡∏ô amount/time)

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (MongoDB)
‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô `notification_channels.settings` (‡∏ï‡πà‡∏≠ ‚Äú‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‚Äù)
```js
{
  slipOkEnabled: Boolean,
  slipOkApiUrl: String,
  slipOkApiKey: String
}
```

## ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡πà‡∏á‡∏£‡∏∞‡∏ö‡∏ö (‡∏™‡∏£‡∏∏‡∏õ)
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠ LINE webhook ‡πÑ‡∏î‡πâ event ‡∏à‡∏≤‡∏Å `group|room`:
  - ‡∏¢‡∏±‡∏á capture ‡∏Å‡∏•‡∏∏‡πà‡∏°/‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ `line_bot_groups` ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
  - ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô `message:image` ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏°‡∏µ `notification_channels` ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î `slipOkEnabled` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö `senderBotId + groupId` ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‚Üí ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å LINE (`getMessageContent`) ‚Üí ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å SlipOK ‚Üí ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢ `replyMessage` (fallback ‡πÄ‡∏õ‡πá‡∏ô `pushMessage` ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ replyToken)

## ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
- Backend:
  - `index.js`
  - `services/slipOkService.js`
- Admin UI:
  - `views/partials/modals/notification-channel-modal.ejs`
  - `public/js/notification-channels.js`
- ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:
  - `docs/slipok-slip-check-plan.md`

