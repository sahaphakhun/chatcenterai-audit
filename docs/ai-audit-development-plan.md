# üó∫Ô∏è AI Order Audit ‚Äì Development Plan (‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏´‡∏•‡∏∏‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)

> **Last updated:** 2025-12-19  
> **Related spec:** `docs/ai-audit-system.md`  

‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ ‚Äú‡πÅ‡∏ö‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏Å‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ó‡∏µ‡∏•‡∏∞‡∏™‡πÄ‡∏ï‡πá‡∏õ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πÄ‡∏ï‡πá‡∏õ‡∏°‡∏µ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ä‡∏±‡∏î, ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏™‡∏£‡πá‡∏à‡πÑ‡∏î‡πâ, ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ

---

## Step 1) Per-page Settings + DB State (‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á + ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏£‡∏≤‡∏¢‡πÄ‡∏û‡∏à)

**Scope**
- ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö `orderAudit` ‡πÉ‡∏ô `follow_up_page_settings`
- ‡πÄ‡∏û‡∏¥‡πà‡∏° collection state: `order_audit_sessions` + TTL index (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏ñ‡∏≤‡∏°‡∏ã‡πâ‡∏≥/‡πÄ‡∏Å‡πá‡∏ö pending)
- ‡∏ó‡∏≥ API ‡∏ù‡∏±‡πà‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô/‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å setting ‡∏£‡∏≤‡∏¢‡πÄ‡∏û‡∏à (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ UI)

**‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å**
- Per-page config: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 10.1
- Session/pending schema: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 10.2

**Deliverables**
- DB:
  - `follow_up_page_settings.orderAudit` (‡∏°‡∏µ `enabled`, `waitForMainAiSeconds`, ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö push_customer ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏ô MVP)
  - `order_audit_sessions` ‡∏û‡∏£‡πâ‡∏≠‡∏° TTL (`expireAt`)
- API:
  - `GET /admin/orders/pages` ‡∏™‡πà‡∏á `orderAudit` ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢
  - `POST /admin/orders/pages/audit-settings` (‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢ endpoint ‡πÄ‡∏î‡∏¥‡∏°) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å `orderAudit`

**Definition of Done**
- ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î audit ‡∏£‡∏≤‡∏¢‡πÄ‡∏û‡∏à‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô API ‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô DB ‡∏à‡∏£‡∏¥‡∏á
- ‡∏Ñ‡πà‡∏≤ default ‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏à‡πÉ‡∏´‡∏°‡πà/‡πÄ‡∏û‡∏à‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

**Manual checks**
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `GET /admin/orders/pages` ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏´‡πá‡∏ô `orderAudit` ‡∏Ñ‡∏£‡∏ö
- POST toggle ‡πÅ‡∏•‡πâ‡∏ß reload ‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà

---

## Step 2) Core Audit Engine (Pure Logic: normalize/validate + message build)

**Scope**
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô logic ‡∏•‡πâ‡∏ß‡∏ô (‡πÑ‡∏°‡πà‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö LINE/FB/OpenAI) ‡πÄ‡∏û‡∏∑‡πà‡∏≠:
  - normalize phone (`+66`/`66` ‚Üí `0xxxxxxxxx`)
  - validate fields ‡∏ï‡∏≤‡∏° requirement ‡∏ó‡∏µ‡πà fix ‡πÑ‡∏ß‡πâ (‡∏ä‡∏∑‡πà‡∏≠/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà/‡∏ï‡∏≥‡∏ö‡∏•/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå/‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£)
  - ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏ú‡∏•: `missingFields` / `isComplete`
  - build ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‚Äú‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‚Äù (template mode)

**‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å**
- Validation/normalize: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 8
- Templates: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 11
- ‚Äú‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà 2 ‡πÅ‡∏ö‡∏ö‚Äù: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 3.2

**Deliverables**
- ‡πÇ‡∏°‡∏î‡∏π‡∏•‡πÄ‡∏ä‡πà‡∏ô `services/orderAuditService.js` (‡∏´‡∏£‡∏∑‡∏≠ `utils/orderAudit.js`) ‡∏ó‡∏µ‡πà export:
  - `normalizeThaiPhone()`
  - `validateOrderDraft(draft)`
  - `buildAuditAskMessage(...)`
  - `buildAuditSummaryMessage(...)`

**Definition of Done**
- ‡πÉ‡∏™‡πà draft ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ missingFields ‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏° spec
- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà generate ‡∏°‡∏µ‡πÅ‡∏Ñ‡πà 2 ‡πÅ‡∏ö‡∏ö (‡∏ñ‡∏≤‡∏°/‡∏™‡∏£‡∏∏‡∏õ) ‡∏ï‡∏≤‡∏° `docs/ai-audit-system.md`

**Manual checks**
- ‡∏ó‡∏≥‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å REPL ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ input/output ‡∏Ç‡∏≠‡∏á phone + postalCode

---

## Step 3) Order Draft Extractor (‡πÅ‡∏¢‡∏Å prompt ‡∏à‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏° + ‡∏Å‡∏±‡∏ô false positive)

**Scope**
- ‡∏ó‡∏≥ extractor ‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏≤‡∏°‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏Ç‡πâ‡∏≠ 7.0:
  - ‡∏Ñ‡∏∑‡∏ô `{ hasDraft, draft }`
  - ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤/‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ï‡πä‡∏≠‡∏Å/‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ü‡∏¥‡∏£‡πå‡∏° ‚Üí `hasDraft=false` ‡πÅ‡∏•‡∏∞ `items=[]`
  - ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô draft ‚Üí `hasDraft=true` ‡πÅ‡∏•‡∏∞ `items.length>=1`
- ‡πÉ‡∏ä‡πâ OpenAI model ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å + JSON schema (‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å `analyzeOrderFromChat()` ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà)

**‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å**
- ‡∏ô‡∏¥‡∏¢‡∏≤‡∏° order draft (‡∏Å‡∏±‡∏ô false positive): `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 7.0
- Output schema: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 7.1
- Rule ‚Äúitems ‡∏ß‡πà‡∏≤‡∏á‡∏´‡πâ‡∏≤‡∏°‡∏™‡πà‡∏á‚Äù: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 3.1 ‡πÅ‡∏•‡∏∞ 6.2#7

**Deliverables**
- `services/orderDraftExtractor.js` (‡∏´‡∏£‡∏∑‡∏≠ function ‡πÉ‡∏ô service ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å OpenAI ‡πÅ‡∏•‡∏∞ parse JSON
- Prompt/JSON schema ‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö `docs/ai-audit-system.md` (hasDraft + items)
- (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥) admin-only debug endpoint ‡πÄ‡∏ä‡πà‡∏ô:
  - `POST /admin/order-audit/test-extract` (input: ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á, output: JSON)

**Definition of Done**
- ‡πÄ‡∏Ñ‡∏™ ‚Äú‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‚Äù ‚Üí `hasDraft=false`
- ‡πÄ‡∏Ñ‡∏™ ‚Äú‡πÄ‡∏≠‡∏≤ 1 ‡∏ä‡∏¥‡πâ‡∏ô‚Äù ‚Üí `hasDraft=true` ‡πÅ‡∏•‡∏∞‡∏°‡∏µ items

**Manual checks**
- ‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ä‡∏ó 3 ‡πÅ‡∏ö‡∏ö (‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤ / ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ / ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠+‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà) ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ú‡∏• JSON

---

## Step 4) Runner + Debounce Scheduler + Push Sending (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö)

**Scope**
- Runner ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà (‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö/‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô FB inbox)
- ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏™‡πà‡∏á:
  - ‡∏ñ‡πâ‡∏≤ `hasDraft=false` ‡∏´‡∏£‡∏∑‡∏≠ `items=[]` ‚Üí STOP (‡πÑ‡∏°‡πà‡∏™‡πà‡∏á)
  - ‡∏ñ‡πâ‡∏≤ main AI **‡∏õ‡∏¥‡∏î** ‚Üí ‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
  - ‡∏ñ‡πâ‡∏≤ main AI **‡πÄ‡∏õ‡∏¥‡∏î** ‚Üí ‡∏ï‡∏±‡πâ‡∏á `session.pending` ‡πÅ‡∏•‡∏∞‡∏£‡∏≠ `waitForMainAiSeconds` (debounce)
  - ‡∏ñ‡πâ‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠ ‚Üí ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å pending ‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà
- ‡∏™‡πà‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢:
  - LINE: `pushMessage`
  - Facebook: `sendFacebookMessage`
- Loop prevention:
  - tag `source/metadata="order_audit"` ‡πÅ‡∏•‡∏∞ runner ignore ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° audit ‡πÄ‡∏≠‡∏á
  - Facebook `is_echo` ‡∏ï‡πâ‡∏≠‡∏á skip metadata `"order_audit"`

**‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å**
- Flow runner/pending/cancel: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 6.2 ‡πÅ‡∏•‡∏∞ 6.3
- ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (AI ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î): `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 3.1.1 ‡πÅ‡∏•‡∏∞ 4.1
- Loop prevention: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 9
- Delivery default push: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 10.1

**Deliverables**
- `OrderAuditRunner` + `DueSender` (interval)
- DB updates ‡πÉ‡∏ô `order_audit_sessions`:
  - `pending.dueAt`, `pending.triggerMessageId`, `askTurns`, `missingFields`, `lastPushedAt`
- ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á (push) ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ß‡∏ô‡∏•‡∏π‡∏õ

**Definition of Done**
- ‡πÄ‡∏õ‡∏¥‡∏î AI ‡∏´‡∏•‡∏±‡∏Å + ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏≠ 60s:
  - ‡∏ñ‡πâ‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏¥‡πà‡∏° ‚Üí ‡∏™‡πà‡∏á‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏£‡∏ö‡πÄ‡∏ß‡∏•‡∏≤
  - ‡∏ñ‡πâ‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≠ ‚Üí ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡πÉ‡∏´‡∏°‡πà
- ‡∏õ‡∏¥‡∏î AI ‡∏´‡∏•‡∏±‡∏Å:
  - ‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)

**Manual checks**
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô LINE ‡πÅ‡∏•‡∏∞ FB ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢:
  - draft ‡∏Ç‡∏≤‡∏î‡πÄ‡∏ö‡∏≠‡∏£‡πå ‚Üí ‡∏ñ‡∏≤‡∏°‡πÄ‡∏ö‡∏≠‡∏£‡πå
  - ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏≠‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏ô 60s ‚Üí ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏ã‡πâ‡∏≥ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà

---

## Step 5) Admin UI + Rollout (‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ)

**Scope**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° UI ‡πÉ‡∏ô `views/admin-orders.ejs` (modal ‡πÄ‡∏î‡∏¥‡∏°) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ per-page:
  - enable/disable
  - `waitForMainAiSeconds`
  - (‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏) MVP ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö push_customer ‡πÅ‡∏•‡∏∞ validate fields ‡πÅ‡∏ö‡∏ö fixed
- Rollout:
  - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 1‚Äì2 ‡πÄ‡∏û‡∏à, monitor log, ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏Ç‡∏¢‡∏≤‡∏¢

**‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å**
- Settings fields: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 10.1 ‡πÅ‡∏•‡∏∞ 13
- Acceptance criteria: `docs/ai-audit-system.md` ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ 12

**Deliverables**
- UI ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å setting ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á (‡πÉ‡∏ä‡πâ endpoint ‡πÉ‡∏ô Step 1)
- ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡πà‡∏≤ default/‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**Definition of Done**
- ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏£‡∏≤‡∏¢‡πÄ‡∏û‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
- ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ debounce ‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ú‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

---

## ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡∏ú‡∏° (agent)

‡∏ó‡∏≥‡∏ó‡∏µ‡∏•‡∏∞ Step ‡∏ï‡∏≤‡∏°‡∏ô‡∏µ‡πâ (‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏™‡πÄ‡∏ï‡πá‡∏õ):
1) Step 1 ‚Üí ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏≠‡∏á toggle ‡∏ú‡πà‡∏≤‡∏ô UI/‡∏´‡∏£‡∏∑‡∏≠ API ‡∏Å‡πà‡∏≠‡∏ô
2) Step 2 ‚Üí ‡∏ú‡∏°‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á input/output ‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß
3) Step 3 ‚Üí ‡πÄ‡∏ó‡∏™ prompt ‡∏î‡πâ‡∏ß‡∏¢ sample chat
4) Step 4 ‚Üí ‡πÄ‡∏ó‡∏™‡∏à‡∏£‡∏¥‡∏á LINE/FB + debounce behavior
5) Step 5 ‚Üí ‡∏ó‡∏≥ UI + rollout
